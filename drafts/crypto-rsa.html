<!DOCTYPE html>
<html lang="fr">
<head>
          <title>xdze2</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" type="text/css" href="/theme/css/normalize.css" />
        <link rel="stylesheet" type="text/css" href="/theme/css/notebook.css" />
        <link rel="stylesheet" type="text/css" href="/theme/css/style.css" />


    <meta name="tags" content="algorithme" />
    <meta name="tags" content="maths" />


<!-- <script src="/theme/js/MathJax.js" type="text/javascript"></script> -->
<!-- <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script> -->
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<script type="text/javascript">
init_mathjax = function() {
    if (window.MathJax) {
        // MathJax loaded
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
            },
            displayAlign: 'center', // Change this to 'center' to center equations.
            "HTML-CSS": {
                styles: {'.MathJax_Display': {"margin": 0}}
            }
        });
        MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
}
init_mathjax();
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<!-- <script src="/theme/js/jquery.min.js" type="text/javascript"></script> -->

<script type="text/javascript">
jQuery(document).ready(function($) {
    $("div.collapseheader").click(function () {
    $header = $(this).children("span").first();
    $codearea = $(this).children(".input_area");
    console.log($(this).children());
    $codearea.slideToggle(500, function () {
        $header.text(function () {
            return $codearea.is(":visible") ? "masquer le code" : "voir le code";
        });
    });
});
});
</script>
</head>

<body>
        <div id="side">
            <header id="banner" >
                    <img src="/theme/images/header.png" />
                    <h1><a href="/">xdze2 <strong></strong></a></h1>
            </header><!-- /#banner -->
            <nav id="menu"><ul>


            <img src="/theme/images/tag_icon.png"   />
                <li ><a href="/tag/physique.html">physique</a></li>
                <li ><a href="/tag/statistiques.html">statistiques</a></li>
                <li ><a href="/tag/visualisation.html">visualisation</a></li>
                <li ><a href="/tag/algorithme.html">algorithme</a></li>

                <li><a href="/tags.html">[plus]</a></li>
            </ul>
            <p>
              <a href='/hello.html'><img src="/theme/images/mail.png"   /></a>
            </p>
          </nav><!-- /#menu -->
        </div>
        <div id="content">
<section id="article">

  <header>
      <img src="/theme/images/doc22.png"    />
      <span>
      <h1 class="entry-title">RSA</h1>
      <span class='summary_date' title="2017-05-25T00:00:00+02:00">
        mai 2017
      </span>

        <span class='summary_tag'><a href='tag/algorithme.html'>algorithme, </a></span>
        <span class='summary_tag'><a href='tag/maths.html'>maths</a></span>

  </span>
  </header>



  <div class="article-content">
    <p>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Chiffrement-RSA">Chiffrement RSA<a class="anchor-link" href="#Chiffrement-RSA">&#182;</a></h1><p>Tentative pour reproduire l'algorithme de chiffrement RSA d'après <a href="https://fr.wikipedia.org/wiki/Chiffrement_RSA">wikipédia</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[48]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">isprime</span><span class="p">(</span> <span class="n">n</span> <span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="k">2</span>==0:
        <span class="k">return</span> <span class="kc">False</span>
    
    <span class="n">kmax</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="n">n</span> <span class="p">)</span> <span class="p">)</span><span class="o">+</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span><span class="o">%</span><span class="k">k</span>==0:
            <span class="k">return</span> <span class="kc">False</span>
        
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[49]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">if</span> <span class="n">isprime</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span> <span class="p">)</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">[1, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41, 43, 47, 53, 59, 61, 67, 71, 73, 79, 83, 89, 97, 101, 103, 107, 109, 113, 127, 131, 137, 139, 149, 151, 157, 163, 167, 173, 179, 181, 191, 193, 197, 199]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[50]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">random</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[51]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">pickprime</span><span class="p">(</span> <span class="n">low</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">999</span> <span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="mi">100</span> <span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">isprime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">n</span>
    <span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;no prime&#39;</span> <span class="p">)</span>
    <span class="k">return</span> <span class="kc">None</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span> <span class="n">pickprime</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="p">]</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[52]:</div>



<div class="output_text output_subarea output_execute_result">
<pre class="ipynb">[293, 619, 443, 733, 853, 521, 991, 547, 139, 773]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="RSA">RSA<a class="anchor-link" href="#RSA">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1.-on-choisit-deux-nombres-premiers-p-=-3,-q-=-11">1. on choisit deux nombres premiers p = 3, q = 11<a class="anchor-link" href="#1.-on-choisit-deux-nombres-premiers-p-=-3,-q-=-11">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[53]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">pickprime</span><span class="p">()</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">pickprime</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;p=</span><span class="si">%i</span><span class="s2">; q=</span><span class="si">%i</span><span class="s2">&quot;</span><span class="o">%</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="p">)</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">p=631; q=293
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[54]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1">## avec l&#39;exemple :</span>
<span class="c1">#p, q = 3, 11</span>
<span class="c1">#p, q = 61, 53</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="2.-leur-produit-n-=-3-&#215;-11-=-33-est-le-module-de-chiffrement">2. leur produit n = 3 &#215; 11 = 33 est le module de chiffrement<a class="anchor-link" href="#2.-leur-produit-n-=-3-&#215;-11-=-33-est-le-module-de-chiffrement">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[55]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;n=</span><span class="si">%i</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">n</span>)
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">n=184883
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="3.-&#966;(n)-=-(3-&#8211;-1)-&#215;-(11-&#8211;-1)-=-2-&#215;-10-=-20-;">3. &#966;(n) = (3 &#8211; 1) &#215; (11 &#8211; 1) = 2 &#215; 10 = 20 ;<a class="anchor-link" href="#3.-&#966;(n)-=-(3-&#8211;-1)-&#215;-(11-&#8211;-1)-=-2-&#215;-10-=-20-;">&#182;</a></h3><p>C'est la valeur de l'indicatrice d'Euler en n...<br>
C'est-à-dire le nombre d'entier inférieure à n, et premier avec n... ok..</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[56]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">phi_n</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;φ(n) = </span><span class="si">%i</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">phi_n</span>)
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">φ(n) = 183960
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Remarque:</strong> <em>Premier avec</em> signifie  plus grand diviseur commum égale à 1</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Algorithme-d'euclide">Algorithme d'euclide<a class="anchor-link" href="#Algorithme-d'euclide">&#182;</a></h4><p>Touve le plus grand commun diviseur (pgcd).<br>
Voir encore <a href="https://fr.wikipedia.org/wiki/Algorithme_d%27Euclide">wikipedia</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[57]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">pgcd</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="p">):</span>
    
    <span class="k">if</span> <span class="n">b</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span>
    <span class="k">elif</span> <span class="n">b</span> <span class="o">&lt;=</span> <span class="n">a</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pgcd</span><span class="p">(</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="o">%</span><span class="k">b</span> )
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pgcd</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">%</span><span class="k">a</span> )

<span class="k">def</span> <span class="nf">isprimewith</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="p">):</span>
    <span class="k">if</span> <span class="n">pgcd</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[58]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">pgcd</span><span class="p">(</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">18</span> <span class="p">)</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[58]:</div>



<div class="output_text output_subarea output_execute_result">
<pre class="ipynb">6</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Est-ce que $\phi(n)$ est bien le nombre d'entier inférieure à n et premier avec n ??</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[59]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">my_phi</span><span class="p">(</span> <span class="n">n</span> <span class="p">):</span>
    <span class="n">primewithn</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">isprimewith</span><span class="p">(</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="p">):</span>
            <span class="n">primewithn</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">i</span> <span class="p">)</span>
            
    <span class="k">return</span> <span class="n">primewithn</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[60]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;my_phi: </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span> <span class="n">my_phi</span><span class="p">(</span> <span class="n">n</span> <span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;φ(n) = </span><span class="si">%i</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">phi_n</span>)
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">my_phi: 183960
φ(n) = 183960
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>magique...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.-choisir-un-entier-naturel-e-premier-avec-&#966;(n)-et-strictement-inf&#233;rieur-&#224;-&#966;(n)">4. choisir un entier naturel e premier avec &#966;(n) et strictement inf&#233;rieur &#224; &#966;(n)<a class="anchor-link" href="#4.-choisir-un-entier-naturel-e-premier-avec-&#966;(n)-et-strictement-inf&#233;rieur-&#224;-&#966;(n)">&#182;</a></h3><p>Il est appelé l'exposant de chiffrement</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[61]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">quandidats</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">phi_n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">isprimewith</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">phi_n</span><span class="p">):</span>
        <span class="n">quandidats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[62]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span> <span class="n">quandidats</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">e</span> <span class="p">)</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">8927
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[63]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">quandidats</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[63]:</div>



<div class="output_text output_subarea output_execute_result">
<pre class="ipynb">[11, 13, 17, 19, 23, 29, 31, 37, 41, 43]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[64]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># On choisit e= 3 (premier avec 20) comme exposant de chiffrement ;</span>

<span class="c1">#e = 3</span>
<span class="c1">#e = 43</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="5.-calculer-l'entier-naturel-d,-inverse-de-e-modulo-&#966;(n),-et-strictement-inf&#233;rieur-&#224;-&#966;(n)">5. calculer l'entier naturel d, inverse de e modulo &#966;(n), et strictement inf&#233;rieur &#224; &#966;(n)<a class="anchor-link" href="#5.-calculer-l'entier-naturel-d,-inverse-de-e-modulo-&#966;(n),-et-strictement-inf&#233;rieur-&#224;-&#966;(n)">&#182;</a></h2><p>appelé exposant de déchiffrement ; d peut se calculer efficacement par l'algorithme d'Euclide étendu.</p>
<p>On veut donc :  <code>e*d % phi(n) == 1</code></p>
<p>ce qui veut dire qu'il y a un entier relatif k tel que :  <code>e*d + k*phi == 1</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[65]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span>   <span class="n">e</span><span class="p">,</span> <span class="n">phi_n</span>

<span class="c1"># Entrée : a, b entiers (naturels)</span>
<span class="c1"># Sortie : r entier (naturel) et  u, v entiers relatifs tels que r = pgcd(a, b) et r = a*u + b*v</span>

<span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">rp</span><span class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">vp</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>

<span class="c1">#les égalités r = a*u+b*v et r&#39; = a*u&#39;+b*v&#39; sont des invariants de boucle</span>

<span class="k">while</span> <span class="n">rp</span> <span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
    <span class="n">q</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="n">r</span> <span class="o">/</span> <span class="n">rp</span> <span class="p">)</span> 
    <span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">rp</span><span class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">vp</span> <span class="o">=</span> <span class="n">rp</span><span class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">vp</span><span class="p">,</span> <span class="n">r</span> <span class="o">-</span> <span class="n">q</span> <span class="o">*</span><span class="n">rp</span><span class="p">,</span> <span class="n">u</span> <span class="o">-</span> <span class="n">q</span><span class="o">*</span><span class="n">up</span><span class="p">,</span> <span class="n">v</span> <span class="o">-</span> <span class="n">q</span><span class="o">*</span><span class="n">vp</span>

<span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

<span class="c1"># donc:</span>

<span class="n">k</span> <span class="o">=</span> <span class="n">v</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">u</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">1 -577 28
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[66]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># l&#39;exposant de déchiffrement est d = 7, l&#39;inverse de 3 modulo 20 (en effet ed = 3 × 7 ≡ 1 mod 20).</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[67]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;d=</span><span class="si">%i</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">d</span> )
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">d=-577
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[68]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span><span class="o">*</span><span class="n">d</span>  <span class="o">%</span> <span class="n">phi_n</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[68]:</div>



<div class="output_text output_subarea output_execute_result">
<pre class="ipynb">1</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[69]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span><span class="o">*</span><span class="n">d</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="n">phi_n</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[69]:</div>



<div class="output_text output_subarea output_execute_result">
<pre class="ipynb">1</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>ok, mais d est négatif ??</p>
<p><a href="https://crypto.stackexchange.com/questions/10805/how-does-one-deal-with-a-negative-d-in-rsa">https://crypto.stackexchange.com/questions/10805/how-does-one-deal-with-a-negative-d-in-rsa</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[70]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="k">while</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span>
    <span class="n">d</span> <span class="o">+=</span> <span class="n">phi_n</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[71]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span><span class="o">*</span><span class="n">d</span>  <span class="o">%</span> <span class="n">phi_n</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[71]:</div>



<div class="output_text output_subarea output_execute_result">
<pre class="ipynb">1</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[72]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;d=</span><span class="si">%i</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">d</span> )
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">d=183383
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Le couple (n,e) est la clé publique du chiffrement,<br>
alors que le nombre d est sa clé privée,</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Chiffrement-du-message">Chiffrement du message<a class="anchor-link" href="#Chiffrement-du-message">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Si M est un entier naturel strictement inférieur à n représentant un message, alors le message chiffré sera représenté par</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[73]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[73]:</div>



<div class="output_text output_subarea output_execute_result">
<pre class="ipynb">184883</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[74]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">M</span> <span class="o">=</span> <span class="mi">123456</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[75]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">C</span> <span class="o">=</span> <span class="n">M</span><span class="o">**</span><span class="n">e</span> <span class="o">%</span> <span class="n">n</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[76]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="n">C</span>  <span class="p">)</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">41459
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="D&#233;chiffrement-du-message">D&#233;chiffrement du message<a class="anchor-link" href="#D&#233;chiffrement-du-message">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[77]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">M_dechif</span> <span class="o">=</span> <span class="n">C</span><span class="o">**</span><span class="n">d</span> <span class="o">%</span> <span class="n">n</span>
</pre></div>

    </div>
</div>

</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[78]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="n">M_dechif</span> <span class="p">)</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">123456
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>yes...</p>
<p>et comment faire pour caser le code... ?  factoriser n pour retrouver p et q ...</p>
<p>et pourquoi $ (M^e \mod n)^d \mod n  = M       $</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[79]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mi">451</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">17</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">31</span>

<span class="nb">print</span><span class="p">(</span>  <span class="p">(</span><span class="n">a</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span><span class="o">**</span><span class="n">p</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>  <span class="p">(</span><span class="n">a</span><span class="o">**</span><span class="n">p</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span> <span class="p">)</span>
</pre></div>

    </div>
</div>

</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>

<div class="output_subarea output_stream output_stdout output_text">
<pre class="ipynb">827240261886336764177
21
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>

<div class="inner_cell">
    <div class="input_area">
        <div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>

</div>

</div>
 

</p>
  </div><!-- /.entry-content -->



</section>
        </div>

</body>
</html>